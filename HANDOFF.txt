â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ClassGuru Payment Service - Ready for Handoff
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ WHAT THIS IS

This folder contains a complete, self-contained Stripe subscription
payment microservice for ClassGuru. It's production-ready and can be
deployed independently.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ FILES IN THIS FOLDER

  README.md              â†’ Complete documentation (setup, API, testing)
  INTEGRATION_NOTE.txt   â†’ How this connects to mainline service
  HANDOFF.txt           â†’ This file

  src/                  â†’ All source code
  â”œâ”€â”€ server.ts         â†’ Main entry point (Fastify server)
  â”œâ”€â”€ handlers/         â†’ Internal billing logic (3 handlers)
  â”œâ”€â”€ routes/           â†’ API endpoints and webhook handler
  â”œâ”€â”€ lib/              â†’ Database, JWT, Stripe, logging
  â””â”€â”€ types/            â†’ TypeScript definitions

  env.example           â†’ Environment variable template
  package.json          â†’ Dependencies and scripts
  tsconfig.json         â†’ TypeScript configuration

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… WHAT'S READY

  âœ“ Complete Stripe integration (checkout, subscriptions, webhooks)
  âœ“ JWT authentication (shares secret with mainline)
  âœ“ SQLite database with idempotent webhook processing
  âœ“ Internal handler system (create, update, query subscriptions)
  âœ“ API routes with validation and error handling
  âœ“ Structured logging
  âœ“ Production-ready code structure

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ QUICK START (for lead developer)

1. Copy this entire folder to deployment location

2. Install dependencies:
   npm install

3. Configure environment:
   cp env.example .env
   # Edit .env with Stripe keys and JWT secret

4. Run development server:
   npm run dev

5. Test health check:
   curl http://localhost:8790/api/payment/health

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— INTEGRATION WITH MAINLINE

This service is called by the mainline orchestrator through the
payment-gateway plugin. The lead developer needs to ensure:

  1. Mainline has: CG_plugins/plugins/payment-gateway.plugin.ts
  2. Mainline config.json includes payment service URL
  3. Both services share the same JWT_SECRET
  4. This service starts on port 8790

See INTEGRATION_NOTE.txt for details.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOCUMENTATION

Everything is in README.md:
  â€¢ Complete setup instructions
  â€¢ API reference with examples
  â€¢ Frontend integration code (React)
  â€¢ Database schema
  â€¢ Security details
  â€¢ Testing guide
  â€¢ Production deployment checklist
  â€¢ Troubleshooting

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”‘ KEY FEATURES

  â€¢ Runs on port 8790 (isolated from mainline)
  â€¢ Uses SQLite for storage (ready for DB migration)
  â€¢ Idempotent webhook handling (prevents duplicates)
  â€¢ JWT-based API authentication
  â€¢ Stripe signature verification
  â€¢ Structured error handling and logging
  â€¢ Monthly subscription plan ($9.90 SGD)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ DEPLOYMENT NOTES

Development:
  npm run dev

Production build:
  npm run build
  npm start

Production checklist in README.md includes:
  â€¢ Switch to live Stripe keys
  â€¢ Configure production webhooks
  â€¢ Use strong JWT secret (64+ chars)
  â€¢ Enable HTTPS
  â€¢ Set up backups
  â€¢ Configure monitoring

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ WHAT LEAD DEVELOPER NEEDS TO KNOW

1. This is a MICROSERVICE (not part of mainline codebase)
2. It communicates via REST API only
3. The mainline calls it through the payment-gateway plugin
4. Both services must be running for payment features to work
5. Start this service BEFORE mainline
6. JWT secret must match exactly

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ STATUS: Production Ready

All code tested and documented. Ready to hand off as single folder.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

